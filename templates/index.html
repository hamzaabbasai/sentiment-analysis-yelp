<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Sentiment Analysis</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css"
    />
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='style.css') }}"
    />
  </head>
  <body>
    <div class="container mt-4">
      <div class="row mb-4">
        <div class="col-12 text-center">
          <h1 class="display-4 mb-3">
            <i class="fas fa-comments text-primary me-3"></i>
            Sentiment Analysis
          </h1>
          <p class="lead text-muted">
            Analyze the sentiment of restaurant reviews using advanced machine
            learning
          </p>
        </div>
      </div>
      <div class="row align-items-start">
        <div class="col-lg-6 mb-4 align-self-start">
          <div class="card shadow-sm">
            <div class="card-header">
              <h5 class="card-title mb-0">
                <i class="fas fa-edit mr-2"></i>
                Review Text
              </h5>
            </div>
            <div class="card-body">
              <form
                action="{{ url_for('analyze') }}"
                method="POST"
                id="sentiment-form"
              >
                <div class="mb-3">
                  <label for="text" class="form-label">Enter your review</label>
                  <textarea
                    class="form-control"
                    id="text"
                    name="text"
                    rows="8"
                    placeholder="Type or paste your restaurant review here..."
                    maxlength="5000"
                    required
                  >
{{ request.form.text if request.form.text else '' }}</textarea
                  >
                  <small class="form-text text-muted">
                    <span id="char-count">0</span>/5000 characters
                  </small>
                </div>
                <div class="d-flex justify-content-end flex-wrap">
                  <button
                    type="button"
                    class="btn btn-outline-secondary btn-sm mr-2"
                    onclick="clearForm()"
                  >
                    <i class="fas fa-times mr-1"></i>
                    Clear
                  </button>
                  <button
                    type="submit"
                    class="btn btn-primary btn-sm"
                    id="analyze-btn"
                  >
                    <i class="fas fa-brain mr-1"></i>
                    Analyze Sentiment
                  </button>
                </div>
              </form>
            </div>
          </div>
        </div>
        <div class="col-lg-6 mb-4">
          <div class="card shadow-sm">
            <div class="card-header">
              <h5 class="card-title mb-0">
                <i class="fas fa-chart-bar mr-2"></i>
                Analysis Results
              </h5>
            </div>

            {% if result %}
            <div class="card-body">
              <div class="row mb-4">
                <div class="col-12 text-center">
                  {% set sentiment_info = { 'positive': {'icon': 'fas fa-smile',
                  'bg': 'success'}, 'neutral': {'icon': 'fas fa-meh', 'bg':
                  'warning'}, 'negative': {'icon': 'fas fa-frown', 'bg':
                  'danger'} } %}
                  <div class="sentiment-result">
                    <div
                      class="sentiment-badge bg-{{ sentiment_info[result.sentiment]['bg'] }} text-white p-4 rounded d-inline-block"
                    >
                      <i
                        class="{{ sentiment_info[result.sentiment]['icon'] }} fa-3x mb-2"
                      ></i>
                      <h3 class="mb-1">{{ result.sentiment.title() }}</h3>
                      <p class="mb-0">
                        Confidence: {{ (result.confidence * 100)|round(1) }}%
                      </p>
                    </div>
                  </div>
                </div>
              </div>

              <div class="row justify-content-center mb-4">
                <div class="col-md-10">
                  <div class="vertical-chart-container">
                    {% for sentiment, probability in
                    result.probabilities.items() %}
                    <div class="vertical-bar-item">
                      <div class="vertical-bar-container">
                        <div
                          class="vertical-bar sentiment-{{ sentiment }}"
                          style="height: {{ (probability * 100)|round(1) }}%;"
                          data-percentage="{{ (probability * 100)|round(1) }}"
                        >
                          <span class="vertical-bar-value"
                            >{{ (probability * 100)|round(1) }}%</span
                          >
                        </div>
                      </div>
                      <div class="vertical-bar-label">
                        <i
                          class="fas fa-{{ 'smile' if sentiment == 'positive' else 'meh' if sentiment == 'neutral' else 'frown' }} mr-1"
                        ></i>
                        {{ sentiment.title() }}
                      </div>
                    </div>
                    {% endfor %}
                  </div>
                </div>
              </div>
              <div class="row">
                <div class="col-12">
                  <h6 class="mb-2">
                    <i class="fas fa-quote-left mr-2"></i>
                    Analyzed Text
                  </h6>
                  <div class="bg-light p-3 rounded">
                    <em>"{{ result.text }}"</em>
                  </div>
                </div>
              </div>
              <div class="row mt-4">
                <div class="col-12 text-center">
                  <button
                    type="button"
                    class="btn btn-outline-primary"
                    onclick="analyzeAnother()"
                  >
                    <i class="fas fa-plus mr-1"></i>
                    Analyze Another Review
                  </button>
                </div>
              </div>
            </div>
            {% else %}
            <div
              class="card-body d-flex align-items-center justify-content-center"
              style="min-height: 360px"
            >
              <div class="text-center text-muted">
                <i class="fas fa-chart-bar fa-2x mb-3"></i>
                <p class="mb-1">Your analysis will appear here.</p>
                <small
                  >Enter a review on the left and click
                  <strong>Analyze Sentiment</strong>.</small
                >
              </div>
            </div>
            {% endif %}
          </div>
        </div>
      </div>
    </div>
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="{{ url_for('static', filename='script.js') }}"></script>
  </body>
</html>
